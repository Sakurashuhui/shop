!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(o="undefined"!=typeof globalThis?globalThis:o||self).NestedScroll=t()}(this,function(){"use strict";var e={duplicateClick:function(o){var t=o[0],n=o[1];t.options.click&&n.options.click&&(n.options.click=!1)},nestedScroll:function(n){var o=n[0],t=n[1],e=o.options.scrollX,r=o.options.scrollY,i=t.options.scrollX,l=t.options.scrollY;e!==i&&r!==l||(n.forEach(function(o,t){var s=n[(t+1)%2];o.on(o.eventTypes.beforeScrollStart,function(){var o,t,n,e,r,i,l,a;s.pending&&(s.stop(),s.resetPosition()),t=f(o=s),n=t.hasHorizontalScroll,e=t.hasVerticalScroll,r=o.scroller,i=r.actions,l=r.scrollBehaviorX,a=r.scrollBehaviorY,i.startTime=+new Date,e?a.startPos=a.currentPos:n&&(l.startPos=l.currentPos),s.disable()}),o.on(o.eventTypes.touchEnd,function(){s.enable()})}),t.on(t.eventTypes.scrollStart,function(){!function(o){var t=f(o),n=t.hasHorizontalScroll,e=t.hasVerticalScroll,r=o.scroller,i=r.scrollBehaviorX,l=r.scrollBehaviorY,a=o.x>=o.minScrollX&&-1===i.movingDirection,s=o.x<=o.maxScrollX&&1===i.movingDirection,c=o.y>=o.minScrollY&&-1===l.movingDirection,p=o.y<=o.maxScrollY&&1===l.movingDirection;{if(e)return c||p;if(n)return a||s}return!1}(t)||(t.disable(),o.enable())}))}};function n(o){var t=n.nestedScroll;return t instanceof n||((t=n.nestedScroll=this).stores=[]),t.setup(o),t.addHooks(o),t}function s(o,t){for(var n=0,e=o.parentNode;e&&e!==t;)n++,e=e.parentNode;return n}function f(o){return{hasHorizontalScroll:o.hasHorizontalScroll,hasVerticalScroll:o.hasVerticalScroll}}return n.prototype.setup=function(o){this.appendBScroll(o),this.handleContainRelationship(),this.handleCompatible()},n.prototype.addHooks=function(o){var t=this;o.on("destroy",function(){t.teardown(o)})},n.prototype.teardown=function(o){this.removeBScroll(o),this.handleContainRelationship(),this.handleCompatible()},n.prototype.appendBScroll=function(o){this.stores.push(o)},n.prototype.removeBScroll=function(o){var t=this.stores.indexOf(o);-1!==t&&(o.wrapper.isBScrollContainer=void 0,this.stores.splice(t,1))},n.prototype.handleContainRelationship=function(){var o=this.stores;if(o.length<=1)o[0]&&o[0].__parentInfo&&(o[0].__parentInfo=void 0);else for(var t,n,e,r=0;r<o.length;r++){n=(t=o[r]).wrapper;for(var i=0;i<o.length;i++){var l,a=(e=o[i]).wrapper;t!==e&&a.contains(n)&&(t.__parentInfo?(l=s(n,a))<t.__parentInfo.depth&&(t.__parentInfo={parent:e,depth:l}):t.__parentInfo={parent:e,depth:s(n,a)})}}},n.prototype.handleCompatible=function(){var o=this.availableBScrolls(),n=["duplicateClick","nestedScroll"];o.forEach(function(t){n.forEach(function(o){e[o](t)})})},n.prototype.availableBScrolls=function(){return this.stores.filter(function(o){return!!o.__parentInfo}).map(function(o){return[o.__parentInfo.parent,o]})},n.pluginName="nestedScroll",n});
